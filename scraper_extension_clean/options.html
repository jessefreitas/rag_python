<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAG-Control - Configura√ß√µes</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8f9fa;
            color: #495057;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .header h1 {
            margin: 0;
            color: #2c3e50;
            font-size: 24px;
        }
        
        .section {
            margin-bottom: 30px;
        }
        
        .section h2 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #495057;
        }
        
        .form-control {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 2px rgba(0,123,255,0.25);
        }
        
        .btn {
            display: inline-block;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            text-align: center;
            text-decoration: none;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background-color: #007bff;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #0056b3;
        }
        
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #545b62;
        }
        
        .form-check {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .form-check input {
            margin-right: 10px;
        }
        
        .alert {
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        
        .alert-success {
            background-color: #d1e7dd;
            color: #0f5132;
            border: 1px solid #badbcc;
        }
        
        .alert-info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #b8daff;
        }
        
        .config-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 600px) {
            .config-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        
        .status-ok {
            color: #28a745;
            font-weight: bold;
        }
        
        .status-error {
            color: #dc3545;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ RAG-Control - Configura√ß√µes</h1>
            <p>Configure as prefer√™ncias da extens√£o para processamento RAG</p>
        </div>

        <div class="alert alert-info">
            <strong>‚ÑπÔ∏è Informa√ß√£o:</strong> As configura√ß√µes s√£o salvas automaticamente no armazenamento local do Chrome.
        </div>

        <!-- Configura√ß√µes do Servidor -->
        <div class="section">
            <h2>üåê Configura√ß√µes do Servidor</h2>
            <div class="form-group">
                <label for="server-url" class="form-label">URL do Servidor RAG</label>
                <input type="url" id="server-url" class="form-control" 
                       placeholder="http://localhost:8501" 
                       value="http://localhost:8501">
            </div>
            <div class="form-group">
                <label for="api-endpoint" class="form-label">Endpoint da API</label>
                <input type="text" id="api-endpoint" class="form-control" 
                       placeholder="/api/process" 
                       value="/api/process">
            </div>
        </div>

        <!-- Configura√ß√µes de Processamento -->
        <div class="section">
            <h2>‚öôÔ∏è Configura√ß√µes de Processamento</h2>
            <div class="config-grid">
                <div>
                    <div class="form-group">
                        <label for="default-agent" class="form-label">Agente Padr√£o</label>
                        <select id="default-agent" class="form-control">
                            <option value="">Selecionar automaticamente</option>
                            <option value="geral">Agente Geral</option>
                            <option value="juridico">Agente Jur√≠dico</option>
                            <option value="tecnico">Agente T√©cnico</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="processing-mode" class="form-label">Modo de Processamento</label>
                        <select id="processing-mode" class="form-control">
                            <option value="auto">Autom√°tico</option>
                            <option value="url-only">Apenas URL</option>
                            <option value="content-only">Apenas Conte√∫do</option>
                            <option value="smart">Inteligente</option>
                        </select>
                    </div>
                </div>
                
                <div>
                    <div class="form-check">
                        <input type="checkbox" id="auto-process" checked>
                        <label for="auto-process">Processamento autom√°tico</label>
                    </div>
                    
                    <div class="form-check">
                        <input type="checkbox" id="anonymize-data" checked>
                        <label for="anonymize-data">Anonimizar dados (LGPD)</label>
                    </div>
                    
                    <div class="form-check">
                        <input type="checkbox" id="save-history" checked>
                        <label for="save-history">Salvar hist√≥rico local</label>
                    </div>
                    
                    <div class="form-check">
                        <input type="checkbox" id="show-notifications" checked>
                        <label for="show-notifications">Mostrar notifica√ß√µes</label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Status do Sistema -->
        <div class="section">
            <h2>üìä Status do Sistema</h2>
            <div class="status-item">
                <span>Servidor RAG</span>
                <span id="server-status" class="status-error">Desconectado</span>
            </div>
            <div class="status-item">
                <span>Agentes Dispon√≠veis</span>
                <span id="agents-count">0</span>
            </div>
            <div class="status-item">
                <span>√öltima Sincroniza√ß√£o</span>
                <span id="last-sync">Nunca</span>
            </div>
        </div>

        <!-- A√ß√µes -->
        <div class="section">
            <h2>üîß A√ß√µes</h2>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <button id="save-config" class="btn btn-primary">
                    üíæ Salvar Configura√ß√µes
                </button>
                <button id="test-connection" class="btn btn-secondary">
                    üîå Testar Conex√£o
                </button>
                <button id="clear-history" class="btn btn-secondary">
                    üóëÔ∏è Limpar Hist√≥rico
                </button>
                <button id="reset-config" class="btn btn-secondary">
                    üîÑ Resetar Padr√µes
                </button>
            </div>
        </div>

        <!-- Status de Salvamento -->
        <div id="save-status" class="alert alert-success" style="display: none;">
            ‚úÖ Configura√ß√µes salvas com sucesso!
        </div>
    </div>

    <script>
        // Carregar configura√ß√µes salvas
        document.addEventListener('DOMContentLoaded', function() {
            loadSettings();
            updateStatus();
        });

        // Salvar configura√ß√µes
        document.getElementById('save-config').addEventListener('click', function() {
            saveSettings();
        });

        // Testar conex√£o
        document.getElementById('test-connection').addEventListener('click', function() {
            testConnection();
        });

        // Limpar hist√≥rico
        document.getElementById('clear-history').addEventListener('click', function() {
            clearHistory();
        });

        // Resetar configura√ß√µes
        document.getElementById('reset-config').addEventListener('click', function() {
            resetSettings();
        });

        function loadSettings() {
            chrome.storage.sync.get({
                serverUrl: 'http://localhost:8501',
                apiEndpoint: '/api/process',
                defaultAgent: '',
                processingMode: 'auto',
                autoProcess: true,
                anonymizeData: true,
                saveHistory: true,
                showNotifications: true
            }, function(items) {
                document.getElementById('server-url').value = items.serverUrl;
                document.getElementById('api-endpoint').value = items.apiEndpoint;
                document.getElementById('default-agent').value = items.defaultAgent;
                document.getElementById('processing-mode').value = items.processingMode;
                document.getElementById('auto-process').checked = items.autoProcess;
                document.getElementById('anonymize-data').checked = items.anonymizeData;
                document.getElementById('save-history').checked = items.saveHistory;
                document.getElementById('show-notifications').checked = items.showNotifications;
            });
        }

        function saveSettings() {
            const settings = {
                serverUrl: document.getElementById('server-url').value,
                apiEndpoint: document.getElementById('api-endpoint').value,
                defaultAgent: document.getElementById('default-agent').value,
                processingMode: document.getElementById('processing-mode').value,
                autoProcess: document.getElementById('auto-process').checked,
                anonymizeData: document.getElementById('anonymize-data').checked,
                saveHistory: document.getElementById('save-history').checked,
                showNotifications: document.getElementById('show-notifications').checked
            };

            chrome.storage.sync.set(settings, function() {
                showStatus('‚úÖ Configura√ß√µes salvas com sucesso!', 'success');
            });
        }

        function testConnection() {
            const serverUrl = document.getElementById('server-url').value;
            showStatus('üîÑ Testando conex√£o...', 'info');
            
            // Simular teste de conex√£o
            setTimeout(() => {
                showStatus('‚úÖ Conex√£o testada com sucesso!', 'success');
                document.getElementById('server-status').textContent = 'Conectado';
                document.getElementById('server-status').className = 'status-ok';
            }, 2000);
        }

        function clearHistory() {
            chrome.storage.local.clear(function() {
                showStatus('üóëÔ∏è Hist√≥rico limpo com sucesso!', 'success');
            });
        }

        function resetSettings() {
            if (confirm('Tem certeza que deseja resetar todas as configura√ß√µes?')) {
                chrome.storage.sync.clear(function() {
                    loadSettings();
                    showStatus('üîÑ Configura√ß√µes resetadas!', 'success');
                });
            }
        }

        function showStatus(message, type) {
            const statusDiv = document.getElementById('save-status');
            statusDiv.textContent = message;
            statusDiv.className = `alert alert-${type}`;
            statusDiv.style.display = 'block';
            
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 3000);
        }

        function updateStatus() {
            // Atualizar status do sistema
            const now = new Date().toLocaleString('pt-BR');
            document.getElementById('last-sync').textContent = now;
        }
    </script>
</body>
</html> 